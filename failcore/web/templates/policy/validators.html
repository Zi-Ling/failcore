{% extends "base.html" %}

{% block title %}Available Validators - FailCore{% endblock %}

{% block content %}
<div class="overview">
    <h1>⚡ Available Validators</h1>
    
    <div style="margin-bottom: 1rem;">
        <a href="/policy" class="btn btn-sm">&larr; BACK</a>
    </div>
    
    <div id="validators-list">
        <div class="empty-state">
            <p>Loading validators...</p>
        </div>
    </div>
</div>

<script>
    async function loadValidators() {
        try {
            const response = await fetch('/api/policy/validators');
            const data = await response.json();
            
            if (data.validators && data.validators.length > 0) {
                const html = `
                    <div class="runs-list">
                        <table class="runs-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>DOMAIN</th>
                                    <th>DESCRIPTION</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${data.validators.map(v => `
                                    <tr>
                                        <td><code class="run-id">${v.id}</code></td>
                                        <td><span class="badge">${v.domain}</span></td>
                                        <td>${v.description || '—'}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                    <div style="margin-top: 1rem; color: var(--text-secondary); font-size: 0.875rem;">
                        Total: <strong>${data.total}</strong> validators
                    </div>
                `;
                
                document.getElementById('validators-list').innerHTML = html;
            } else {
                document.getElementById('validators-list').innerHTML = 
                    '<div class="empty-state"><p>No validators registered</p></div>';
            }
        } catch (e) {
            document.getElementById('validators-list').innerHTML = 
                `<div class="empty-state"><p style="color: var(--red-500);">Failed to load validators: ${e.message}</p></div>`;
        }
    }
    
    loadValidators();
</script>
{% endblock %}
